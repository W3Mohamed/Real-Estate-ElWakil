{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content_title %}
    <i class="fa fa-check-circle text-success"></i> Comptes créés avec succès
{% endblock %}

{% block main %}
    {% if created_users is not empty %}
        <div class="card">
            <div class="card-header bg-success text-white">
                <h3 class="card-title mb-0">
                    <i class="fa fa-users"></i> 
                    {{ created_users|length }} compte(s) créé(s)
                </h3>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="fa fa-exclamation-triangle"></i>
                    <strong>Important :</strong> Notez bien ces informations de connexion, elles ne seront plus affichées !
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Nom d'utilisateur</th>
                                <th>Mot de passe</th>
                                <th>Rôle</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in created_users %}
                                <tr>
                                    <td>
                                        <strong>{{ user.username }}</strong>
                                    </td>
                                    <td>
                                        <code class="bg-light p-1">{{ user.password }}</code>
                                        <button class="btn btn-sm btn-outline-secondary ms-2" 
                                                onclick="copyToClipboard('{{ user.password }}')"
                                                title="Copier le mot de passe">
                                            <i class="fa fa-copy"></i>
                                        </button>
                                    </td>
                                    <td>
                                        <span class="badge bg-info">ROLE_AGENCE</span>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="mt-3">
                    <a href="{{ ea_url().setController('App\\Controller\\Admin\\UserCrudController').setAction('index') }}" 
                       class="btn btn-primary">
                        <i class="fa fa-list"></i> Voir tous les utilisateurs
                    </a>
                    <a href="{{ path('admin_generate_users') }}" class="btn btn-success">
                        <i class="fa fa-plus"></i> Créer d'autres comptes
                    </a>
                </div>
            </div>
        </div>
    {% else %}
        <div class="alert alert-info">
            <i class="fa fa-info-circle"></i>
            Aucun compte à afficher.
            <a href="{{ path('admin_generate_users') }}" class="btn btn-success btn-sm ms-2">
                Créer des comptes
            </a>
        </div>
    {% endif %}

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Optionnel : afficher une notification
                alert('Mot de passe copié dans le presse-papiers !');
            });
        }
    </script>
{% endblock %}